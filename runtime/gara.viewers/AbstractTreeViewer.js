gara.provide("gara.viewers.AbstractTreeViewer","gara.viewers.ColumnViewer");gara.Class("gara.viewers.AbstractTreeViewer",function(){return{$extends:gara.viewers.ColumnViewer,$constructor:function(){this.$super()},createTreeItem:function(b,e,c){var d=this.newItem(b,gara.NULL,c);this.updateItem(d,e)},disassociate:function(b){this.$super(b);this.disassociateChildren(b)},disassociateChildren:function(b){var e=this.getChildren(b);for(var c=0;c<e.length;c++){if(e[c].getData()!==null){this.disassociate(e[c])}}},doGetColumnCount:function(){return 0},doGetSelection:function(){},doFindInputItem:function(b){var e=this.getRoot();if(e===null){return null}if(e===b){return this.getControl()}return null},doFindItem:function(b){var e=getRoot(),c,d,g;if(e===null){return null}c=this.getChildren(this.getControl());if(c!==null){for(d=0;d<c.length;d++){g=this.internalFindItem(c[d],b);if(g!==null){return g}}}return null},doUpdateItem:function(b,e){var c,d,g,f,h;if(b.isDisposed()){this.unmapElement(e,b);return}c=this.getViewerRowFromItem(b);d=this.doGetColumnCount();if(d===0){d=1}for(g=0;g<d;g++){f=this.getViewerColumn(g);h=this.updateCell(c,g,e);f.refresh(h);if(b.isDisposed()){this.unmapElement(e,b);return}}this.associate(e,b)},getChildren:function(){},getControl:function(){},getExpanded:function(b){},getLabelProviderText:function(b,e){var c=null;if(b.getText){c=b.getText(e)}if(c===null){c=""}return c},getRawChildren:function(b){var e=this.getContentProvider(),c;if(b===this.getRoot()){return this.$super(b)}else if(e.getChildren){c=e.getChildren(b);if(c!==null){return c}}return[]},getSelectionFromWidget:function(){var b=this.doGetSelection(),e=[],c,d,g;for(d=0;d<b.length;d++){c=b[d];g=c.getData();if(g!==null){e.push(g)}}return e},inputChanged:function(b,e){this.treeRemoveAll();this.internalRefresh()},internalFindItem:function(b,e){var c=b.getData(),d,g,f;if(c!==null){if(c===e){return b}}d=this.getChildren(b);for(g=0;g<d.length;g++){f=this.internalFindItem(d[g],e);if(f!==null){return f}}return null},internalRefresh:function(c,d){var g=[],f=this.getControl().getSelection(),h,a;for(h=0;h<f.length;++h){g.push(f[h].getData())}if(typeof(c)==="undefined"||c===null||c===this.getRoot()){this.internalRefreshItems(this.getControl(),this.getRoot(),d)}else{a=this.findItems(c);if(a.length!==0){for(h=0;h<a.length;h++){this.internalRefreshItems(a[h],c,d)}}}f=[];g.forEach(function(b){var e=this.getItemFromElementMap(b);if(e!==null){f.push(e)}},this);this.getControl().update();this.getControl().setSelection(f)},internalRefreshItems:function(b,e,c){var d,g,f,h;this.updateChildren(b,e,c);d=this.getChildren(b);if(d!==null){for(g=0;g<d.length;g++){f=d[g];h=f.getData();if(h!==null){this.internalRefreshItems(f,h,c)}}}},newItem:function(b,e,c){},setExpanded:function(b,e){},treeRemoveAll:function(){},updateChildren:function(b,e,c){var d=this.getSortedChildren(e),g=this.getControl(),f=this.getChildren(b),h=[],a,n,j,m,o,l,i,p,k;for(a=0;a<f.length;++a){if(this.getExpanded(f[a])){n=f[a].getData();if(n!==null){h.push(n)}}}j=Math.min(d.length,f.length);m=f.length-j;if(m>0){o=[];for(a=0;a<d.length;a++){o.push(d[a])}a=0;while(m>0&&a<f.length){l=f[a].getData();if(l===null||f.length-a<=m||!o.contains(l)){if(l!==null){this.disassociate(f[a])}f[a].dispose();f.removeAt(a);m--}else{a++}}}for(a=0;a<j;++a){i=f[a];p=i.getData();if(p!==null){k=d[a];if(k===p){l=i.getData();if(l!==null){this.unmapElement(l,i)}i.setData(k);this.mapElement(k,i)}else{this.disassociate(i);i.setImage(null);i.setText("")}}}for(a=0;a<j;++a){i=f[a];k=d[a];if(i.getData()===null){this.associate(k,i);this.updateItem(i,k)}else{if(c){this.updateItem(i,k)}}}for(a=0;a<j;++a){if(h.contains(f[a].getData())){this.setExpanded(f[a],true)}else{this.setExpanded(f[a],false)}}if(j<d.length){for(a=j;a<d.length;++a){this.createTreeItem(b,d[a],a)}if(h.length>0){f=this.getChildren(b);for(a=j;a<d.length;++a){if(h.contains(d[a])){this.setExpanded(f[a],true)}}}}},setContentProvider:function(b){this.contentProvider=b}}});