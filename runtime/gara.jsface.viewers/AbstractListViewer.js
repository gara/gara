gara.provide("gara.jsface.viewers.AbstractListViewer");gara.require("gara.jsface.viewers.StructuredViewer");$package("gara.jsface.viewers");$class("AbstractListViewer",{$extends:gara.jsface.viewers.StructuredViewer,$constructor:function(){this._storedSelection=[]},_createListItem:$abstract(function(c,d,f){}),_doFindInputItem:function(c){var d=this._getRoot();if(d==null){return null}if(d==c){return this.getControl()}return null},_doGetSelection:$abstract(function(){}),_doUpdateItem:function(c,d){if(c.isDisposed()){this._unmapElement(d,c);return}c.setText(this._getLabelProviderText(this.getLabelProvider(),d));c.setImage(this.getLabelProvider().getImage(d));this._associate(d,c)},getControl:$abstract(function(){}),_getLabelProviderText:function(c,d){var f=c.getText(d);if(f==null){f=""}return f},_getSelectionFromWidget:function(){var c=this._doGetSelection();var d=[];for(var f=0;f<c.length;f++){var k=c[f];var h=k.getData();if(h!=null){d.push(h)}}return d},inputChanged:function(c,d){this._listRemoveAll();this.getControl().setSelection([]);this._internalRefresh()},_internalRefresh:function(h,r){if(h==null||h==this._getRoot()){var o=[];var l=this.getControl().getSelection();for(var a=0;a<l.length;++a){o.push(l[a].getData())}var g=this._getSortedChildren(this._getRoot());var e=this.getControl().getItems();var s=e.length;var m=Math.min(g.length,e.length);var n=e.length-m;if(n>0){var p=[];for(var a=0;a<g.length;a++){p.push(g[a])}var a=0;while(n>0&&a<e.length){var j=e[a].getData();if(j==null||e.length-a<=n||!p.contains(j)){if(j!=null){this._disassociate(e[a])}e[a].dispose();e.removeAt(a);n--}else{a++}}}for(var a=0;a<m;++a){var b=e[a];var q=b.getData();if(q!=null){var i=g[a];if(i==q){var j=b.getData();if(j!=null){this._unmapElement(j,b)}b.setData(i);this._mapElement(i,b)}else{this._disassociate(b);b.setImage(null);b.setText("")}}}for(var a=0;a<m;++a){var b=e[a];var i=g[a];if(b.getData()==null){this._associate(i,b);this._updateItem(b,i)}else{if(r){this._updateItem(b,i)}}}if(m<g.length){for(var a=m;a<g.length;++a){var b=this._createListItem(g[a],gara.jswt.JSWT.DEFAULT,a);this._associate(g[a],b)}}var l=[];o.forEach(function(c,d,f){var k=this._getItemFromElementMap(c);if(k!=null&&!k.isDisposed()){l.push(k)}},this);this.getControl().update();this.getControl().setSelection(l)}else{var b=this._getItemFromElementMap(h);if(b!=null){this._updateItem(b,h)}this.getControl().update()}},_listRemoveAll:$abstract(function(){}),_listSetItems:$abstract(function(){})});$package("");