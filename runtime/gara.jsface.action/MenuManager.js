gara.provide("gara.jsface.action.MenuManager");gara.provide("gara.jsface.action.ActionChangedListener");gara.provide("gara.jsface.action.IAction");gara.provide("gara.jswt.JSWT");gara.provide("gara.jswt.events.SelectionListener");gara.provide("gara.jswt.widgets.Control");gara.provide("gara.jswt.widgets.Menu");gara.provide("gara.jswt.widgets.MenuItem");gara.Class("MenuManager",{$implements:[gara.jswt.events.SelectionListener,gara.jsface.action.ActionChangedListener],$constructor:function(a,b){this._items=[];this._menus=[];this._enabled=true;this._text=a;this._image=b},actionChanged:function(a){this.updateAction(a)},addAction:function(a){if(!gara.instanceOf(a,gara.jsface.action.IAction)){throw new TypeError("action not instance of gara.jsface.action.IAction");}if(!this._items.contains(a)){a.addActionChangedListener(this);this._items.push(a)}},addMenuManager:function(a){if(!gara.instanceOf(a,gara.jsface.action.MenuManager)){throw new TypeError("manager not instance of gara.jsface.action.MenuManager");}if(!this._items.contains(a)){this._items.push(a)}},createContextMenu:function(a){if(!gara.instanceOf(a,gara.jswt.widgets.Control)){throw new TypeError("control ist not instance of gara.jswt.widgets.Control");}var b=new gara.jswt.widgets.Menu(a);this._menus.push(b);this.updateMenu(b);a.setMenu(b)},createMenuBar:function(a){var b=new gara.jswt.widgets.Menu(a);this._menus.push(b);this.updateMenu(b)},_createMenuItem:function(a,b){var c=new gara.jswt.widgets.MenuItem(a,gara.jswt.JSWT.CASCADE);c.setText(b.getText());c.setImage(b.getImage());c.setEnabled(b.getEnabled());c.setData(b);c.addSelectionListener(this);if(gara.instanceOf(b,gara.jsface.action.MenuManager)&&b.getSize()){this._createSubmenu(c,b)}},_createSubmenu:function(a,b){b.submenu=new gara.jswt.widgets.Menu(a);a.setMenu(b.submenu);b.fillMenu(b.submenu)},fillMenu:function(a){if(!gara.instanceOf(a,gara.jswt.widgets.Menu)){throw new TypeError("menu ist not instance of gara.jswt.widgets.Menu");}if(!this._menus.contains(a)){this._menus.push(a);for(var b=0;b<this._items.length;b++){this._createMenuItem(a,this._items[b])}}},getEnabled:function(){return this._enabled},getImage:function(){return this._image},getSize:function(){return this._items.length},getText:function(){return this._text},removeAction:function(a){if(!gara.instanceOf(a,gara.jsface.action.IAction)){throw new TypeError("action not instance of gara.jsface.action.IAction");}a.removeActionChangedListener(this);this._items.remove(a)},setEnabled:function(a){this._enabled=a},setImage:function(a){this._image=a},setText:function(a){this._text=a},update:function(b){if(gara.instanceOf(b,gara.jswt.widgets.Menu)){this.updateMenu(b)}else if(gara.instanceOf(b,gara.jsface.action.IAction)){this.updateAction(b)}else{this._menus.forEach(function(a){this.updateMenu(a)},this)}},updateAction:function(c){this._menus.forEach(function(b){b.getItems().forEach(function(a){if(a.getData()==c){a.setText(c.getText());a.setImage(c.getImage());a.setEnabled(c.getEnabled());b.update()}},this)},this)},updateMenu:function(a){var b=a.getItems();var c=b.length;var g=Math.min(c,this._items.length);for(var d=0;d<g;d++){var e=b[d];var f=this._items[d];e.setText(f.getText());e.setImage(f.getImage());e.setEnabled(f.getEnabled());e.setData(f);if(gara.instanceOf(f,gara.jsface.action.MenuManager)){if(f.submenu){f.update(f.submenu)}else{this._createSubmenu(e,f)}}}for(var d=g;d<c;d++){var e=b[d];e.setData(null);e.removeSelectionListener(this);e.dispose()}for(var d=g;d<this._items.length;d++){this._createMenuItem(a,this._items[d])}a.update()},widgetSelected:function(a){if(gara.instanceOf(a.item,gara.jswt.widgets.MenuItem)){var b=a.item.getData();if(gara.instanceOf(b,gara.jsface.action.IAction)){b.run()}}}});