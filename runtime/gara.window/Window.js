gara.provide("gara.window.Window");gara.use("gara.widgets.Display");gara.use("gara.widgets.Shell");gara.Class("gara.window.Window",{shell:null,parentShell:null,contents:null,windowManager:null,$constructor:function(a){if(typeof(a)!=="undefined"&&!(a instanceof gara.widgets.Shell)){throw new TypeError("parentShell not instance of gara.widgets.Shell");}this.parent=a||gara.widgets.Display.getDefault();this.contents=null;this.shell=null;this.windowManager=null;this.callback=null;this.context=null;this.returnValue=null},canHandleShellCloseEvent:function(){return true},close:function(){if(this.windowManager!==null){this.windowManager.remove(this);this.windowManager=null}if(this.shell!==null||!this.shell.isDisposed()){this.shell.dispose();this.shell=null;this.contents=null}if(this.callback!==null){if(this.context!==null){this.callback.call(this.context,this.getReturnValue())}else{this["callback"](this.getReturnValue())}}},configureShell:function(a){var b=this.getLayout();if(b!==null){a.setLayout(b)}},create:function(){this.shell=this.createShell();this.contents=this.createContents(this.shell);this.initializeBounds()},createContents:function(a){if(!(a instanceof gara.widgets.Composite)){throw new TypeError("parent not instance of gara.widgets.Composite");}return new gara.widgets.Composite(a)},createShell:function(){var a;a=new gara.widgets.Shell(this.getParentShell(),this.getShellStyle());a.setData(this);a.addShellListener(this.getShellListener());this.configureShell(a);return a},getInitialSize:function(){var a=this.shell.getParent(),b=a instanceof gara.widgets.Display?document.documentElement.clientWidth:a.getClientArea().clientWidth,c=a instanceof gara.widgets.Display?document.documentElement.clientHeight:a.getClientArea().clientHeight;return{x:Math.floor(b/2),y:Math.floor(c/2)}},getInitialLocation:function(a){var b=this.shell.getParent(),c=b instanceof gara.widgets.Display?document.documentElement.clientWidth:b.getClientArea().clientWidth,d=b instanceof gara.widgets.Display?document.documentElement.clientHeight:b.getClientArea().clientHeight;return{x:Math.floor((c/2)-(a.x/2)),y:Math.floor((d/2)-(a.y/2))}},getLayout:function(){return null},getParentShell:function(){return this.parent},getReturnValue:function(){return this.returnValue},getShell:function(){return this.shell},getShellListener:function(){var b=this;return{shellClosed:function(a){if(b.canHandleShellCloseEvent()){b.handleShellCloseEvent()}return false}}},getShellStyle:function(){return 0},getWindowManager:function(){return this.windowManager},handleShellCloseEvent:function(){this.setReturnValue(gara.CANCEL);this.close()},initializeBounds:function(){var a=this.getInitialSize(),b=this.getInitialLocation(a);this.shell.setSize(a.x,a.y);if(b!==null){this.shell.setLocation(b.x,b.y)}},open:function(a,b){if(this.shell==null||this.shell.isDisposed()){this.shell=null;this.create()}this.callback=a||this.callback;this.context=b||this.context;this.shell.open();this.shell.layout()},setReturnValue:function(a){this.returnValue=a},setWindowManager:function(a){var b,c;if(!(a instanceof gara.window.WindowManager)){throw new TypeError("manager not instance of gara.window.WindowManager");}this.windowManager=a;if(a!=null){b=a.getWindows();for(c=0;c<b.length;c++){if(b[c]==this){return}}a.add(this)}}});