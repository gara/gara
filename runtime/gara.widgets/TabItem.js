gara.provide("gara.widgets.TabItem","gara.widgets.Item");gara.use("gara.widgets.Control");gara.use("gara.widgets.Menu");gara.use("gara.widgets.MenuItem");gara.use("gara.widgets.TabFolder");gara.Class("gara.widgets.TabItem",function(){return{$extends:gara.widgets.Item,active:false,control:null,toolTipText:null,menuItem:null,span:null,img:null,clientArea:null,$constructor:function(a,b){if(!(a instanceof gara.widgets.TabFolder)){throw new TypeError("parentWidget is neither a gara.widgets.TabFolder");}this.$super(a,b);this.active=false;this.control=null;this.toolTipText=null;this.menuItem=null;this.span=null;this.img=null;this.clientArea=null;this.parentNode=this.parent.addItem(this);this.createWidget()},bindListener:function(a,b){gara.addEventListener(this.handle,a,b)},close:function(){if(this.parent.notifyTabFolderListener("close")){this.dispose()}},createWidget:function(){var b=this;this.handle=document.createElement("li");this.handle.className=this.classes.join(" ");this.handle.id=this.getId();this.handle.widget=this;this.handle.control=this.parent;this.handle.setAttribute("role","tab");this.handle.setAttribute("aria-controls",this.getId()+"-panel");this.handle.setAttribute("aria-owns",this.getId()+"-panel");this.handle.setAttribute("aria-selected",this.active);this.handle.setAttribute("aria-labelledby",this.getId()+"-label");if(this.toolTipText!==null){this.handle.title=this.toolTipText}this.door=document.createElement("span");this.door.widget=this;this.door.control=this.parent;this.door.className="garaTabItemDoor";this.door.setAttribute("role","presentation");this.handle.appendChild(this.door);this.img=document.createElement("img");this.img.id=this.getId()+"-image";this.img.widget=this;this.img.control=this.tree;this.img.className="garaTabItemImage garaItemImage";this.img.setAttribute("role","presentation");if(this.image!==null){this.img.src=this.image.src}else{this.img.style.display="none"}this.spanText=document.createTextNode(this.text);this.span=document.createElement("span");this.span.id=this.getId()+"-label";this.span.widget=this;this.span.control=this.parent;this.span.className="garaTabItemText garaItemText";this.span.appendChild(this.spanText);this.span.setAttribute("role","presentation");if((this.style&gara.CLOSE)!==0){this.closeButton=document.createElement("span");this.closeButton.className="garaDecorationsCloseButton";this.closeButton.widget=this;this.door.appendChild(this.closeButton)}this.door.appendChild(this.img);this.door.appendChild(this.span);this.addClass("garaTabItem");this.clientArea=document.createElement("div");this.clientArea.style.display=this.active?"block":"none";this.clientArea.id=this.getId()+"-panel";this.clientArea.setAttribute("aria-hidden",!this.active);this.clientArea.setAttribute("role","tabpanel");this.clientArea.setAttribute("aria-labelledby",this.getId()+"-label");this.parent.getClientArea().appendChild(this.clientArea);if(this.control){this.clientArea.appendChild(this.control.handle)}if(this.parent.getDropDownMenu()){this.menuItem=new gara.widgets.MenuItem(this.parent.getDropDownMenu());this.menuItem.setText(this.text);this.menuItem.setImage(this.image);this.menuItem.setVisible(false);this.menuItem.setData("gara__tabItem",this);this.menuItem.update();this.setData("gara__menuItem",this.menuItem);this.menuItem.addSelectionListener({widgetSelected:function(a){b.parent.activateItem(b)}})}this.parentNode.appendChild(this.handle);this.parent.updateMeasurements()},destroyWidget:function(){this.parent.releaseItem(this);if(this.control!==null){this.control.release()}this.control=null;this.menuItem=null;this.$super()},getClientArea:function(){return this.clientArea},getControl:function(){this.checkWidget();return this.control},getToolTipText:function(){this.checkWidget();return this.toolTipText},handleEvent:function(a){this.checkWidget();if(a.type==="mousedown"&&a.target===this.closeButton){this.close()}if(a.type==="contextmenu"){a.preventDefault()}},setActive:function(a){this.checkWidget();this.active=a;this.setClass("garaActiveItem",this.active);if(this.handle){this.handle.setAttribute("aria-selected",this.active);this.clientArea.setAttribute("aria-hidden",!this.active);this.clientArea.style.display=this.active?"block":"none";if(a){this.clientArea.style.height=this.parent.getClientArea().clientHeight+"px";this.clientArea.style.width=this.parent.getClientArea().clientWidth+"px"}}},setControl:function(a){var b;this.checkWidget();if(!(a instanceof gara.widgets.Control)){throw new TypeError("control is not instance of gara.widgets.Control");}b=gara.getStyle(this.getClientArea(),"overflow");this.getClientArea().style.overflow="hidden";this.control=a;if(a instanceof gara.widgets.Scrollable){this.control.setHeight(this.parent.getClientArea().offsetHeight-gara.getNumStyle(this.parent.getClientArea(),"padding-top")-gara.getNumStyle(this.parent.getClientArea(),"padding-bottom")-gara.getNumStyle(this.parent.getClientArea(),"border-top-width")-gara.getNumStyle(this.parent.getClientArea(),"border-bottom-width"));this.control.setWidth(this.parent.getClientArea().offsetWidth-gara.getNumStyle(this.parent.getClientArea(),"padding-left")-gara.getNumStyle(this.parent.getClientArea(),"padding-right")-gara.getNumStyle(this.parent.getClientArea(),"border-left-width")-gara.getNumStyle(this.parent.getClientArea(),"border-right-width"))}this.getClientArea().style.overflow=b;if(this.clientArea){this.clientArea.innerHTML="";this.clientArea.appendChild(this.control.handle)}return this},setImage:function(a){this.$super(a);if(this.menuItem!==null){this.menuItem.setImage(this.image)}if(a!==null){this.img.src=a.src;this.img.style.display=""}else{this.img.src="";this.img.style.display="none"}return this},setText:function(a){this.$super(a);if(this.menuItem!==null){this.menuItem.setText(this.text)}this.spanText.nodeValue=this.text;return this},setToolTipText:function(a){this.toolTipText=a;if(a!==""||a!==null){this.handle.title=this.toolTipText}return this},unbindListener:function(a,b){gara.removeEventListener(this.handle,a,b)},update:function(){this.checkWidget();if(this.control!==null){this.control.update()}}}});